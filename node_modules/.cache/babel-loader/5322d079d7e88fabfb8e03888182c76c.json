{"ast":null,"code":"import _classCallCheck from\"C:\\\\Users\\\\ASUS\\\\Desktop\\\\REACT\\\\TestHook\\\\testhook\\\\front-end\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"C:\\\\Users\\\\ASUS\\\\Desktop\\\\REACT\\\\TestHook\\\\testhook\\\\front-end\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _inherits from\"C:\\\\Users\\\\ASUS\\\\Desktop\\\\REACT\\\\TestHook\\\\testhook\\\\front-end\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import _createSuper from\"C:\\\\Users\\\\ASUS\\\\Desktop\\\\REACT\\\\TestHook\\\\testhook\\\\front-end\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";import React,{Component}from'react';import{Route,Switch,Redirect,withRouter}from'react-router-dom';import axios from'axios';import Login from'./Containers/Auth/Login/Login';import Signup from'./Containers/Auth/Signup/Signup';import Logout from'./Containers/Auth/Logout/Logout';import ResetPassword from'./Containers/Auth/ForgetPassword/ResetPassword/ResetPassword';import SetNewPassword from'./Containers/Auth/ForgetPassword/NewPassword/NewPassword';import Index from'./Containers/Index/Index';import Shop from'./Containers/Shop/Index';import DetailProduct from'./Containers/DetailProduct/Index';import Cart from'./Containers/Checkout/ShoppingCart/Index';import Shipping from'./Containers/Checkout/Shipping/Index';import Payment from'./Containers/Checkout/Payment/Index';import CompleteOrder from'./Containers/Checkout/Index';var App=/*#__PURE__*/function(_Component){_inherits(App,_Component);var _super=_createSuper(App);function App(){var _this;_classCallCheck(this,App);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={isAuth:false,token:null,userId:null,error:null,fetchedProducts:[]};_this.setAutoLogout=function(milliseconds){setTimeout(function(){_this.logoutHandler();},milliseconds);};_this.logoutHandler=function(){_this.setState({isAuth:false,token:null});localStorage.removeItem('token');localStorage.removeItem('expiryDate');localStorage.removeItem('userId');localStorage.removeItem('name');window.location.reload(false);};_this.signupHandler=function(event,authData){event.preventDefault();_this.setState({authLoading:true});fetch('http://localhost:8080/auth/signup',{method:'PUT',headers:{'Content-Type':'application/json'},body:JSON.stringify({email:authData.signupForm.email.value,password:authData.signupForm.password.value,name:authData.signupForm.name.value})}).then(function(res){if(res.status===422){throw new Error(\"Validation failed. Make sure the email address isn't used yet!\");}if(res.status!==200&&res.status!==201){console.log('Error!');throw new Error('Creating a user failed!');}return res.json();}).then(function(resData){_this.props.history.push('/login');}).catch(function(err){console.log(err);});};_this.loginHandler=function(event,authData){event.preventDefault();fetch('http://localhost:8080/auth/login',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({email:authData.email,password:authData.password})}).then(function(res){if(res.status===422){throw new Error('Validation failed');}if(res.status!==200&&res.status!==201){throw new Error('Could not authenticate you!');}return res.json();}).then(function(resData){_this.setState({isAuth:true,token:resData.token,userId:resData.userId});localStorage.setItem('token',resData.token);localStorage.setItem('userId',resData.userId);var remainingMilliseconds=60*60*1000;var expiryDate=new Date(new Date().getTime()+remainingMilliseconds);localStorage.setItem('expiryDate',expiryDate.toISOString());_this.setAutoLogout(remainingMilliseconds);}).then(function(result){_this.props.history.push('/');}).catch(function(err){console.log(err);_this.setState({isAuth:false,error:err});});};_this.responseSuccessGoogle=function(response){axios({method:\"POST\",url:'http://localhost:8080/auth/googleLogin',data:{tokenId:response.tokenId}}).then(function(res){if(res.status===422){throw new Error('Validation failed');}if(res.status!==200&&res.status!==201){throw new Error('Could not authenticate you!');}return res.data;}).then(function(resData){_this.setState({isAuth:true,token:resData.token,userId:resData.userId});localStorage.setItem('token',resData.token);localStorage.setItem('userId',resData.userId);var remainingMilliseconds=60*60*1000;var expiryDate=new Date(new Date().getTime()+remainingMilliseconds);localStorage.setItem('expiryDate',expiryDate.toISOString());_this.setAutoLogout(remainingMilliseconds);}).then(function(result){_this.props.history.push('/');}).catch(function(err){console.log(err);_this.setState({isAuth:false,error:err});});};_this.responseErrorGoogle=function(response){};_this.responseFacebook=function(response){axios({method:\"POST\",url:'http://localhost:8080/auth/facebookLogin',data:{accessToken:response.accessToken,userID:response.userID,name:response.name}}).then(function(response){if(response.status===422){throw new Error('Validation failed');}if(response.status!==200&&response.status!==201){throw new Error('Could not authenticate you!');}return response;}).then(function(resData){console.log(resData);_this.setState({isAuth:true,token:resData.accessToken,userId:resData.userID});localStorage.setItem('token',resData.token);localStorage.setItem('userId',resData.userId);var remainingMilliseconds=60*60*1000;var expiryDate=new Date(new Date().getTime()+remainingMilliseconds);localStorage.setItem('expiryDate',expiryDate.toISOString());_this.setAutoLogout(remainingMilliseconds);}).then(function(result){_this.props.history.push('/');}).catch(function(err){console.log(err);_this.setState({isAuth:false,error:err});});};return _this;}_createClass(App,[{key:\"componentDidMount\",value:function componentDidMount(){var token=localStorage.getItem('token');var expiryDate=localStorage.getItem('expiryDate');if(!token||!expiryDate){return;}if(new Date(expiryDate)<=new Date()){this.logoutHandler();return;}var userId=localStorage.getItem('userId');var remainingMilliseconds=new Date(expiryDate).getTime()-new Date().getTime();this.setState({isAuth:true,token:token,userId:userId});this.setAutoLogout(remainingMilliseconds);}},{key:\"render\",value:function render(){var _this2=this;var routes=/*#__PURE__*/React.createElement(Switch,null,/*#__PURE__*/React.createElement(Route,{path:\"/reset\",exact:true,render:function render(props){return/*#__PURE__*/React.createElement(ResetPassword,props);}}),/*#__PURE__*/React.createElement(Route,{path:\"/reset/:token\",exact:true,render:function render(props){return/*#__PURE__*/React.createElement(SetNewPassword,props);}}),/*#__PURE__*/React.createElement(Route,{path:\"/login\",exact:true,render:function render(props){return/*#__PURE__*/React.createElement(Login,Object.assign({},props,{onLogin:_this2.loginHandler,responseSuccessGoogle:_this2.responseSuccessGoogle,responseErrorGoogle:_this2.responseErrorGoogle,responseFacebook:_this2.responseFacebook}));}}),/*#__PURE__*/React.createElement(Route,{path:\"/signup\",exact:true,render:function render(props){return/*#__PURE__*/React.createElement(Signup,Object.assign({},props,{userId:_this2.state.userId,token:_this2.state.token,isAuth:_this2.state.isAuth,onSignup:_this2.signupHandler}));}}),/*#__PURE__*/React.createElement(Route,{path:\"/shop\",exact:true,render:function render(props){return/*#__PURE__*/React.createElement(Shop,Object.assign({},props,{userId:_this2.state.userId,token:_this2.state.token,isAuth:_this2.state.isAuth}));}}),/*#__PURE__*/React.createElement(Route,{path:\"/cart\",exact:true,render:function render(props){return/*#__PURE__*/React.createElement(Cart,Object.assign({},props,{userId:_this2.state.userId,token:_this2.state.token,isAuth:_this2.state.isAuth}));}}),/*#__PURE__*/React.createElement(Route,{path:\"/\",exact:true,render:function render(props){return/*#__PURE__*/React.createElement(Index,{userId:_this2.state.userId,token:_this2.state.token,isAuth:_this2.state.isAuth});}}),/*#__PURE__*/React.createElement(Route,{path:\"/:productId\",exact:true,render:function render(props){return/*#__PURE__*/React.createElement(DetailProduct,Object.assign({},props,{userId:_this2.state.userId,token:_this2.state.token,isAuth:_this2.state.isAuth}));}}),/*#__PURE__*/React.createElement(Redirect,{to:\"/\"}));if(this.state.isAuth){routes=/*#__PURE__*/React.createElement(Switch,null,/*#__PURE__*/React.createElement(Route,{path:\"/logout\",exact:true,render:function render(props){return/*#__PURE__*/React.createElement(Logout,Object.assign({},props,{onLogout:_this2.logoutHandler}));}}),/*#__PURE__*/React.createElement(Route,{path:\"/shop\",exact:true,render:function render(props){return/*#__PURE__*/React.createElement(Shop,Object.assign({},props,{userId:_this2.state.userId,token:_this2.state.token,isAuth:_this2.state.isAuth}));}}),/*#__PURE__*/React.createElement(Route,{path:\"/cart\",exact:true,render:function render(props){return/*#__PURE__*/React.createElement(Cart,Object.assign({},props,{userId:_this2.state.userId,token:_this2.state.token,isAuth:_this2.state.isAuth}));}}),/*#__PURE__*/React.createElement(Route,{path:\"/shipping\",exact:true,render:function render(props){return/*#__PURE__*/React.createElement(Shipping,Object.assign({},props,{userId:_this2.state.userId,token:_this2.state.token,isAuth:_this2.state.isAuth}));}}),/*#__PURE__*/React.createElement(Route,{path:\"/payment\",exact:true,render:function render(props){return/*#__PURE__*/React.createElement(Payment,Object.assign({},props,{userId:_this2.state.userId,token:_this2.state.token,isAuth:_this2.state.isAuth}));}}),/*#__PURE__*/React.createElement(Route,{path:\"/completeOrder\",exact:true,render:function render(props){return/*#__PURE__*/React.createElement(CompleteOrder,Object.assign({},props,{userId:_this2.state.userId,token:_this2.state.token,isAuth:_this2.state.isAuth}));}}),/*#__PURE__*/React.createElement(Route,{path:\"/:productId\",exact:true,render:function render(props){return/*#__PURE__*/React.createElement(DetailProduct,Object.assign({},props,{userId:_this2.state.userId,token:_this2.state.token,isAuth:_this2.state.isAuth}));}}),/*#__PURE__*/React.createElement(Route,{path:\"/\",exact:true,render:function render(props){return/*#__PURE__*/React.createElement(Index,{userId:_this2.state.userId,token:_this2.state.token,isAuth:_this2.state.isAuth});}}),/*#__PURE__*/React.createElement(Redirect,{to:\"/\"}));}return/*#__PURE__*/React.createElement(\"div\",null,routes);}}]);return App;}(Component);export default withRouter(App);","map":{"version":3,"sources":["C:/Users/ASUS/Desktop/REACT/TestHook/testhook/front-end/src/App.js"],"names":["React","Component","Route","Switch","Redirect","withRouter","axios","Login","Signup","Logout","ResetPassword","SetNewPassword","Index","Shop","DetailProduct","Cart","Shipping","Payment","CompleteOrder","App","state","isAuth","token","userId","error","fetchedProducts","setAutoLogout","milliseconds","setTimeout","logoutHandler","setState","localStorage","removeItem","window","location","reload","signupHandler","event","authData","preventDefault","authLoading","fetch","method","headers","body","JSON","stringify","email","signupForm","value","password","name","then","res","status","Error","console","log","json","resData","props","history","push","catch","err","loginHandler","setItem","remainingMilliseconds","expiryDate","Date","getTime","toISOString","result","responseSuccessGoogle","response","url","data","tokenId","responseErrorGoogle","responseFacebook","accessToken","userID","getItem","routes"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport { Route,Switch,Redirect,withRouter} from 'react-router-dom'\nimport axios from 'axios'\n\nimport Login from './Containers/Auth/Login/Login'\nimport Signup from './Containers/Auth/Signup/Signup';\nimport Logout from './Containers/Auth/Logout/Logout'\nimport ResetPassword from './Containers/Auth/ForgetPassword/ResetPassword/ResetPassword'\nimport SetNewPassword from './Containers/Auth/ForgetPassword/NewPassword/NewPassword'\nimport Index from './Containers/Index/Index'\nimport Shop from './Containers/Shop/Index'\nimport DetailProduct from './Containers/DetailProduct/Index';\n\nimport Cart from './Containers/Checkout/ShoppingCart/Index'\nimport Shipping from './Containers/Checkout/Shipping/Index'\nimport Payment from './Containers/Checkout/Payment/Index'\nimport CompleteOrder from './Containers/Checkout/Index'\nclass App extends Component {\n  state = {\n    isAuth: false,\n    token: null,\n    userId: null,\n    error: null,\n    fetchedProducts:[]\n  };\n  setAutoLogout = milliseconds => {\n    setTimeout(() => {\n      this.logoutHandler();\n    }, milliseconds);\n  };\n  componentDidMount() {\n  \n    const token = localStorage.getItem('token');\n    const expiryDate = localStorage.getItem('expiryDate');\n    if (!token || !expiryDate) {\n      return;\n    }\n    if (new Date(expiryDate) <= new Date()) {\n      this.logoutHandler();\n      return;\n    }\n    const userId = localStorage.getItem('userId');\n    const remainingMilliseconds =\n      new Date(expiryDate).getTime() - new Date().getTime();\n    this.setState({ isAuth: true, token: token, userId: userId });\n    this.setAutoLogout(remainingMilliseconds);\n  }\n  \n  logoutHandler = () => {\n    this.setState({ isAuth: false, token: null });\n    localStorage.removeItem('token');\n    localStorage.removeItem('expiryDate');\n    localStorage.removeItem('userId');\n    localStorage.removeItem('name');\n    window.location.reload(false)\n  };\n  \n  signupHandler = (event, authData) => {\n    event.preventDefault();\n    this.setState({ authLoading: true });\n    fetch('http://localhost:8080/auth/signup', {\n      method: 'PUT',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        email: authData.signupForm.email.value,\n        password: authData.signupForm.password.value,\n        name: authData.signupForm.name.value\n      })\n    })\n      .then(res => {\n        if (res.status === 422) {\n          throw new Error(\n            \"Validation failed. Make sure the email address isn't used yet!\"\n          );\n        }\n        if (res.status !== 200 && res.status !== 201) {\n          console.log('Error!');\n          throw new Error('Creating a user failed!');\n        }\n        return res.json();\n      })\n      .then(resData => {\n        this.props.history.push('/login');\n      })\n      .catch(err => {\n        console.log(err);\n      });\n  };\n  loginHandler=(event,authData)=>{\n    event.preventDefault();\n    fetch('http://localhost:8080/auth/login',{\n      method:'POST',\n      headers:{\n        'Content-Type':'application/json'\n      },\n      body:JSON.stringify({\n        email:authData.email,\n        password:authData.password\n      })\n    })\n    .then(res=>{\n      if(res.status===422){\n        throw new Error('Validation failed')\n      }\n      if(res.status !== 200 && res.status !==201){\n        throw new Error('Could not authenticate you!')\n      }\n      return res.json()\n    })\n    .then(resData=>{\n      this.setState({\n        isAuth: true,\n        token: resData.token,\n        userId: resData.userId\n      });\n      localStorage.setItem('token',resData.token);\n      localStorage.setItem('userId',resData.userId)\n      const remainingMilliseconds=60*60*1000;\n      const expiryDate=new Date(\n        new Date().getTime() + remainingMilliseconds\n      )\n      localStorage.setItem('expiryDate',expiryDate.toISOString())\n      this.setAutoLogout(remainingMilliseconds);\n    })\n    .then(result=>{\n      this.props.history.push('/');\n    })\n    .catch(err=>{\n      console.log(err)\n      this.setState({\n        isAuth: false,\n        error: err\n      });\n    })\n  }\n \n  responseSuccessGoogle=(response)=>{\n    axios({ \n      method:\"POST\",\n      url:'http://localhost:8080/auth/googleLogin',\n      data:{tokenId:response.tokenId}\n    })\n    .then(res=>{\n      if(res.status===422){\n        throw new Error('Validation failed')\n      }\n      if(res.status !== 200 && res.status !==201){\n        throw new Error('Could not authenticate you!')\n      }\n      \n      return res.data\n    })\n    .then(resData=>{\n      this.setState({\n        isAuth: true,\n        token: resData.token,\n        userId: resData.userId\n      });\n      localStorage.setItem('token',resData.token);\n      localStorage.setItem('userId',resData.userId);\n      const remainingMilliseconds=60*60*1000;\n      const expiryDate=new Date(\n        new Date().getTime() + remainingMilliseconds\n      )\n      localStorage.setItem('expiryDate',expiryDate.toISOString())\n      this.setAutoLogout(remainingMilliseconds);\n    })\n    .then(result=>{\n      this.props.history.push('/');\n    })\n    .catch(err=>{\n      console.log(err)\n      this.setState({\n        isAuth: false,\n        error: err\n      });\n    })\n  }\n  responseErrorGoogle=(response)=>{\n  }\n  responseFacebook=(response)=>{\n    axios({\n      method:\"POST\",\n      url:'http://localhost:8080/auth/facebookLogin',\n      data:{accessToken:response.accessToken,userID:response.userID,name:response.name}\n    })\n    .then(response=>{\n      if(response.status===422){\n        throw new Error('Validation failed')\n      }\n      if(response.status !== 200 && response.status !==201){\n        throw new Error('Could not authenticate you!')\n      }\n    \n      return response\n    })\n    .then(resData=>{\n      console.log(resData)\n      this.setState({\n        isAuth: true,\n        token: resData.accessToken,\n        userId: resData.userID\n      });\n      localStorage.setItem('token',resData.token);\n      localStorage.setItem('userId',resData.userId)\n      const remainingMilliseconds=60*60*1000;\n      const expiryDate=new Date(\n        new Date().getTime() + remainingMilliseconds\n      )\n      localStorage.setItem('expiryDate',expiryDate.toISOString())\n      this.setAutoLogout(remainingMilliseconds);\n    })\n    .then(result=>{\n      this.props.history.push('/');\n    })\n    .catch(err=>{\n      console.log(err)\n      this.setState({\n        isAuth: false,\n        error: err\n      });\n    })\n}\n\n\n\n  render () {\n    let routes=(\n      <Switch>\n <Route \n        path=\"/reset\"\n        exact\n        render={props=>(\n          <ResetPassword {...props}></ResetPassword>\n        )}\n        />\n        <Route path=\"/reset/:token\" exact render={props=>(<SetNewPassword {...props} />)}></Route>\n      <Route\n        path=\"/login\"\n        exact\n        render={props => (\n          <Login\n            {...props}\n            onLogin={this.loginHandler} \n            responseSuccessGoogle={this.responseSuccessGoogle}\n            responseErrorGoogle={this.responseErrorGoogle}\n            responseFacebook={this.responseFacebook}\n         \n          />\n        )}\n      />\n      <Route\n        path=\"/signup\"\n        exact\n        render={props => (\n          <Signup\n            {...props} userId={this.state.userId} token={this.state.token} isAuth={this.state.isAuth}\n            onSignup={this.signupHandler}          \n          />\n        )}\n      />\n     \n      <Route\n      path=\"/shop\"\n      exact \n      render={props=>(\n        <Shop {...props} userId={this.state.userId} token={this.state.token} isAuth={this.state.isAuth}></Shop>\n      )}\n      ></Route>\n      <Route path=\"/cart\" exact\n       render={props=>(<Cart {...props} userId={this.state.userId} token={this.state.token} isAuth={this.state.isAuth}></Cart>)}></Route>\n        <Route\n            path=\"/\"\n            exact\n            render={props => (\n              <Index userId={this.state.userId} token={this.state.token} isAuth={this.state.isAuth} />\n            )}\n          />\n          \n        <Route path=\"/:productId\" exact\n         render={props=>(< DetailProduct {...props}  userId={this.state.userId} token={this.state.token} isAuth={this.state.isAuth}\n          ></ DetailProduct>)} />\n      <Redirect to=\"/\" />\n    </Switch>\n    )\n    if(this.state.isAuth){\n      routes=(\n        <Switch>\n            <Route path=\"/logout\" exact \n            render={props=>(<Logout {...props} onLogout={this.logoutHandler}></Logout>)} ></Route>\n       <Route\n      path=\"/shop\"\n      exact \n      render={props=>(\n        <Shop {...props} userId={this.state.userId} token={this.state.token} isAuth={this.state.isAuth}></Shop>\n      )}\n      ></Route>\n      <Route path=\"/cart\" exact  render={props=>(<Cart {...props} userId={this.state.userId} token={this.state.token} isAuth={this.state.isAuth}></Cart>)}></Route>\n     <Route path=\"/shipping\" exact render={props=>(<Shipping {...props} userId={this.state.userId} token={this.state.token} isAuth={this.state.isAuth} />)}></Route>\n     <Route path=\"/payment\" \n      exact render={props=>(<Payment {...props} userId={this.state.userId} token={this.state.token} isAuth={this.state.isAuth} />)}></Route>\n    <Route path=\"/completeOrder\" exact render={props=>(<CompleteOrder {...props} userId={this.state.userId} token={this.state.token} isAuth={this.state.isAuth}></CompleteOrder>)} ></Route>\n     <Route path=\"/:productId\" exact render={props=>(< DetailProduct {...props} userId={this.state.userId} token={this.state.token} isAuth={this.state.isAuth}></ DetailProduct>)} />\n\n        <Route\n            path=\"/\"\n            exact\n            render={props => (\n              <Index userId={this.state.userId} token={this.state.token} isAuth={this.state.isAuth} />\n            )}\n          />\n          \n      <Redirect to=\"/\" />\n        </Switch>\n      )\n    }\n\n    return (\n      <div>\n       {routes}\n      </div>\n   \n    );\n  }\n}\n\nexport default withRouter(App);\n"]},"metadata":{},"sourceType":"module"}