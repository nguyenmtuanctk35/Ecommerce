{"ast":null,"code":"import _regeneratorRuntime from\"C:\\\\Users\\\\ASUS\\\\Desktop\\\\REACT\\\\TestHook\\\\testhook\\\\front-end\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _objectSpread from\"C:\\\\Users\\\\ASUS\\\\Desktop\\\\REACT\\\\TestHook\\\\testhook\\\\front-end\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";import _asyncToGenerator from\"C:\\\\Users\\\\ASUS\\\\Desktop\\\\REACT\\\\TestHook\\\\testhook\\\\front-end\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"C:\\\\Users\\\\ASUS\\\\Desktop\\\\REACT\\\\TestHook\\\\testhook\\\\front-end\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import Block from'../../BlockInfor/BlockInfor';import Paginator from'./Paginator';import Pagination from'@material-ui/lab/Pagination';import'./ListProducts.css';import{useHistory}from'react-router-dom';var imgSrc=require('../../../Assets/banner.png');var ListProducts=function ListProducts(props){var initialPage=parseInt(localStorage.getItem('page'),10);var _useState=useState(initialPage||1),_useState2=_slicedToArray(_useState,2),page=_useState2[0],setPage=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),posts=_useState4[0],setPosts=_useState4[1];var _useState5=useState(0),_useState6=_slicedToArray(_useState5,2),totalPosts=_useState6[0],setTotalPosts=_useState6[1];useEffect(function(){loadPosts();history.push('/shop?='+page);},[page]);var history=useHistory();var loadPosts=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return fetch(process.env.BACKEND_URL+'/products/productsShop?page='+page).then(function(res){if(res.status!==200){throw new Error('Failed to fetch!');}return res.json();}).then(function(resData){var fetchedProducts=[];for(var key in resData.products){fetchedProducts.push(_objectSpread(_objectSpread({},resData.products[key]),{},{id:resData.products[key]._id}));}var totalPages=Math.ceil(resData.totalPages);setPosts(fetchedProducts);setTotalPosts(totalPages);}).catch(function(err){return console.log(err);});case 2:case\"end\":return _context.stop();}}},_callee);}));return function loadPosts(){return _ref.apply(this,arguments);};}();var handleChange=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(event,value){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:setPage(value);_context2.next=3;return localStorage.setItem('page',value);case 3:window.scrollTo(0,0);case 4:case\"end\":return _context2.stop();}}},_callee2);}));return function handleChange(_x,_x2){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/React.createElement(\"div\",{className:\"col-md-8 col-lg-10\",style:{display:'inline-block',marginTop:'1rem'}},/*#__PURE__*/React.createElement(\"img\",{src:imgSrc,alt:\"\",style:{width:'100%',height:'auto',display:'block'}}),/*#__PURE__*/React.createElement(Paginator,null,posts.map(function(el){return/*#__PURE__*/React.createElement(Block,{key:el.id,imgSrc:el.thumbnail_url,link:el.id,title:el.name,price:el.list_price,discountPrice:el.price});})),/*#__PURE__*/React.createElement(Pagination,{color:\"primary\",count:totalPosts,page:page,onChange:handleChange}));};export default ListProducts;","map":{"version":3,"sources":["C:/Users/ASUS/Desktop/REACT/TestHook/testhook/front-end/src/Components/ShopComponents/ListProducts/ListProducts.js"],"names":["React","useState","useEffect","Block","Paginator","Pagination","useHistory","imgSrc","require","ListProducts","props","initialPage","parseInt","localStorage","getItem","page","setPage","posts","setPosts","totalPosts","setTotalPosts","loadPosts","history","push","fetch","process","env","BACKEND_URL","then","res","status","Error","json","resData","fetchedProducts","key","products","id","_id","totalPages","Math","ceil","catch","err","console","log","handleChange","event","value","setItem","window","scrollTo","display","marginTop","width","height","map","el","thumbnail_url","name","list_price","price"],"mappings":"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","sourcesContent":["import React, { useState,useEffect } from 'react';\r\nimport Block from '../../BlockInfor/BlockInfor'\r\nimport Paginator from './Paginator'\r\nimport Pagination from '@material-ui/lab/Pagination';\r\nimport './ListProducts.css'\r\nimport {useHistory} from 'react-router-dom'\r\nconst imgSrc=require('../../../Assets/banner.png')\r\n\r\nconst ListProducts =props=> {\r\n \r\n    const initialPage=parseInt(localStorage.getItem('page'),10)\r\n    const [page,setPage]=useState((initialPage)||1);\r\n    const [posts,setPosts]=useState([]);\r\n    const [totalPosts,setTotalPosts]=useState(0)\r\n    useEffect(()=>{\r\n         loadPosts();\r\n         history.push('/shop?='+page)\r\n    },[page])\r\n\r\n    let history=useHistory();\r\n   const loadPosts =async () => {\r\n      await fetch(process.env.BACKEND_URL+'/products/productsShop?page=' + page)\r\n          .then(res=>{\r\n              if(res.status !==200){\r\n                  throw new Error('Failed to fetch!')\r\n              }\r\n              return res.json()\r\n          \r\n        })\r\n        .then(resData=>{\r\n                let fetchedProducts=[];\r\n               \r\n            for(let key in resData.products){\r\n                fetchedProducts.push({\r\n                    ...resData.products[key],\r\n                    id:resData.products[key]._id,\r\n                })\r\n            } \r\n            const totalPages=Math.ceil(resData.totalPages)\r\n            setPosts(fetchedProducts)\r\n            setTotalPosts(totalPages)\r\n        })\r\n          .catch(err=>console.log(err));\r\n      };\r\n  \r\n      const handleChange=async(event,value)=>{\r\n          setPage(value);\r\n      await localStorage.setItem('page',value);\r\n        \r\n     window.scrollTo(0,0)\r\n      }\r\n    return (\r\n      \r\n        <div className=\"col-md-8 col-lg-10\" style={{display:'inline-block',marginTop:'1rem'}}>\r\n            <img src={imgSrc} alt=\"\" style={{width:'100%',height:'auto',display:'block'}}></img>\r\n       <Paginator \r\n       >\r\n             {posts.map(el=>(\r\n                      <Block key={el.id} imgSrc={el.thumbnail_url} link={el.id}\r\n               title={el.name}\r\n               price={el.list_price}\r\n               discountPrice={el.price} \r\n               ></Block>              \r\n           ))}\r\n       </Paginator>\r\n       <Pagination  color=\"primary\"  count={totalPosts} page={page} onChange={handleChange} />\r\n\r\n         </div>\r\n   \r\n    );\r\n}\r\n\r\nexport default ListProducts"]},"metadata":{},"sourceType":"module"}